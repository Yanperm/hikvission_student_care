<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Admin - Complete System</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Kanit', sans-serif; background: #f5f7fa; }
        .navbar { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .container { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; transition: transform 0.3s; }
        .stat-card:hover { transform: translateY(-5px); }
        .stat-card h3 { font-size: 42px; color: #667eea; margin: 10px 0; }
        .stat-card p { color: #666; font-size: 14px; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s; }
        .btn:hover { transform: scale(1.05); }
        .btn-danger { background: linear-gradient(135deg, #f44336 0%, #e91e63 100%); }
        .btn-success { background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%); }
        .btn-warning { background: linear-gradient(135deg, #FF9800 0%, #FFC107 100%); }
        .btn-sm { padding: 8px 16px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid #e0e0e0; }
        th { background: #f8f9fa; font-weight: 600; }
        .badge { padding: 5px 15px; border-radius: 20px; font-size: 14px; font-weight: 600; }
        .badge-active { background: #d4edda; color: #155724; }
        .badge-expired { background: #f8d7da; color: #721c24; }
        .badge-warning { background: #fff3cd; color: #856404; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; overflow-y: auto; }
        .modal-content { background: white; width: 90%; max-width: 900px; margin: 50px auto; border-radius: 20px; padding: 40px; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .close-btn { font-size: 32px; cursor: pointer; color: #999; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-family: 'Kanit', sans-serif; font-size: 16px; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #667eea; }
        .form-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .full-width { grid-column: 1 / -1; }
        .tab-buttons { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .search-box { padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; width: 300px; margin-bottom: 20px; }
        .action-buttons { display: flex; gap: 10px; }
        .chart-container { position: relative; height: 300px; margin: 20px 0; }
        .package-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 10px; }
        .package-card { border: 3px solid #e0e0e0; padding: 20px; border-radius: 12px; cursor: pointer; text-align: center; transition: all 0.3s; }
        .package-card:hover { border-color: #667eea; transform: translateY(-5px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3); }
        .package-card.selected { border-color: #667eea; background: #f0f4ff; box-shadow: 0 5px 20px rgba(102, 126, 234, 0.5); }
        .package-card h4 { color: #667eea; margin-bottom: 10px; font-size: 20px; }
        .package-card .price { font-size: 24px; font-weight: 700; color: #333; margin: 10px 0; }
        .package-card .capacity { color: #666; font-size: 14px; }
    </style>
</head>
<body>
    <nav class="navbar">
        <h1>üëë Super Admin Dashboard</h1>
        <div>
            <span>SOFTUBON CO.,LTD.</span> | 
            <a href="/logout" style="color: white; text-decoration: none;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
        </div>
    </nav>

    <div class="container">
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <p>üè´ ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                <h3 id="totalSchools">0</h3>
            </div>
            <div class="stat-card">
                <p>ü§ù Reseller/Partner</p>
                <h3 id="totalResellers">0</h3>
            </div>
            <div class="stat-card">
                <p>üë• ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                <h3 id="totalStudents">0</h3>
            </div>
            <div class="stat-card">
                <p>üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>
                <h3 id="monthlyRevenue">‡∏ø0</h3>
            </div>
            <div class="stat-card">
                <p>‚ö†Ô∏è ‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</p>
                <h3 id="expiringSoon">0</h3>
            </div>
            <div class="stat-card">
                <p>üìä Active Rate</p>
                <h3 id="activeRate">0%</h3>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-buttons">
            <button class="btn" id="btnDashboard" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="btn" id="btnSchools" onclick="showTab('schools')" style="background: #6c757d;">üè´ ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
            <button class="btn" id="btnResellers" onclick="showTab('resellers')" style="background: #6c757d;">ü§ù Reseller</button>
            <button class="btn" id="btnFinance" onclick="showTab('finance')" style="background: #6c757d;">üí∞ ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</button>
            <button class="btn" id="btnReports" onclick="showTab('reports')" style="background: #6c757d;">üìà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
            <button class="btn" id="btnSettings" onclick="showTab('settings')" style="background: #6c757d;">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboardTab" class="card">
            <h2>üìä Dashboard Analytics</h2>
            <div class="chart-container">
                <canvas id="revenueChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="schoolsChart"></canvas>
            </div>
        </div>

        <!-- Schools Tab -->
        <div id="schoolsTab" class="card" style="display: none;">
            <h2>üè´ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                <input type="text" class="search-box" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô..." onkeyup="searchSchools(this.value)">
                <button class="btn" onclick="openAddSchoolModal()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
            </div>
            <table id="schoolsTable">
                <thead>
                    <tr>
                        <th>‡∏£‡∏´‡∏±‡∏™</th>
                        <th>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                        <th>‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡πá‡∏à</th>
                        <th>‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                        <th>‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="7" style="text-align: center;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Resellers Tab -->
        <div id="resellersTab" class="card" style="display: none;">
            <h2>ü§ù ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Reseller / Partner</h2>
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                <input type="text" class="search-box" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ Reseller..." onkeyup="searchResellers(this.value)">
                <button class="btn" onclick="openAddResellerModal()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° Reseller</button>
            </div>
            <table id="resellersTable">
                <thead>
                    <tr>
                        <th>‡∏£‡∏´‡∏±‡∏™</th>
                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</th>
                        <th>‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡πá‡∏à</th>
                        <th>‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ/‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß</th>
                        <th>Commission</th>
                        <th>‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="8" style="text-align: center;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Finance Tab -->
        <div id="financeTab" class="card" style="display: none;">
            <h2>üí∞ ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h2>
            <div class="stats-grid" style="margin-bottom: 30px;">
                <div class="stat-card">
                    <p>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                    <h3 id="todayRevenue">‡∏ø0</h3>
                </div>
                <div class="stat-card">
                    <p>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>
                    <h3 id="monthRevenue">‡∏ø0</h3>
                </div>
                <div class="stat-card">
                    <p>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ</p>
                    <h3 id="yearRevenue">‡∏ø0</h3>
                </div>
                <div class="stat-card">
                    <p>‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞</p>
                    <h3 id="pendingPayment">‡∏ø0</h3>
                </div>
            </div>
            <button class="btn" onclick="openPaymentModal()">‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
            <table id="paymentsTable">
                <thead>
                    <tr>
                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                        <th>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/Reseller</th>
                        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                        <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="6" style="text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Reports Tab -->
        <div id="reportsTab" class="card" style="display: none;">
            <h2>üìà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</label>
                    <select id="reportType">
                        <option value="revenue">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</option>
                        <option value="schools">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
                        <option value="resellers">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Reseller</option>
                        <option value="expiring">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</label>
                    <select id="reportPeriod">
                        <option value="today">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</option>
                        <option value="week">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</option>
                        <option value="month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</option>
                        <option value="year">‡∏õ‡∏µ‡∏ô‡∏µ‡πâ</option>
                        <option value="custom">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á</option>
                    </select>
                </div>
            </div>
            <div class="action-buttons">
                <button class="btn" onclick="generateReport()">üìä ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
                <button class="btn btn-success" onclick="exportExcel()">üì• Export Excel</button>
                <button class="btn btn-danger" onclick="exportPDF()">üìÑ Export PDF</button>
            </div>
            <div id="reportResult" style="margin-top: 30px;"></div>
        </div>

        <!-- Settings Tab -->
        <div id="settingsTab" class="card" style="display: none;">
            <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</label>
                    <input type="text" value="SOFTUBON CO.,LTD.">
                </div>
                <div class="form-group">
                    <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                    <input type="email" value="admin@softubon.com">
                </div>
                <div class="form-group">
                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label>
                    <input type="tel" value="02-xxx-xxxx">
                </div>
                <div class="form-group">
                    <label>Line Official</label>
                    <input type="text" value="@softubon">
                </div>
                <div class="form-group full-width">
                    <label>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ß‡∏±‡∏ô)</label>
                    <input type="number" value="30">
                </div>
            </div>
            <button class="btn btn-success" onclick="saveSettings()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>
    </div>

    <!-- Modal ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
    <div id="addSchoolModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
                <span class="close-btn" onclick="closeAddSchoolModal()">&times;</span>
            </div>
            
            <form id="addSchoolForm" onsubmit="submitSchool(event)">
                <div class="form-group full-width">
                    <label>üì¶ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡πá‡∏à *</label>
                    <div class="package-cards">
                        <div class="package-card" onclick="selectSchoolPackage('Starter', 100, 990, 9900, 84000)">
                            <div style="font-size: 36px;">üè´</div>
                            <h4>Starter</h4>
                            <div class="capacity">1-100 ‡∏Ñ‡∏ô</div>
                            <div class="price">‡∏ø990/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                        </div>
                        <div class="package-card" onclick="selectSchoolPackage('Professional', 500, 2990, 29900, 251000)">
                            <div style="font-size: 36px;">üè´</div>
                            <h4>Professional</h4>
                            <div class="capacity">101-500 ‡∏Ñ‡∏ô</div>
                            <div class="price">‡∏ø2,990/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                        </div>
                        <div class="package-card" onclick="selectSchoolPackage('Business', 2000, 7990, 79900, 671000)">
                            <div style="font-size: 36px;">üè´</div>
                            <h4>Business</h4>
                            <div class="capacity">501-2,000 ‡∏Ñ‡∏ô</div>
                            <div class="price">‡∏ø7,990/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                        </div>
                    </div>
                    <input type="hidden" id="schoolPackage" name="package" required>
                    <input type="hidden" id="schoolMaxStudents" name="max_students" required>
                </div>

                <div class="form-group full-width">
                    <label>üè´ ‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô *</label>
                    <input type="text" name="name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ß‡∏ô" required>
                </div>

                <div class="form-group">
                    <label>üìç ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î *</label>
                    <input type="text" name="province" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£" required>
                </div>

                <div class="form-group">
                    <label>üìÖ ‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ *</label>
                    <input type="date" id="schoolExpireDate" name="expire_date" required>
                </div>

                <hr style="margin: 30px 0; border: none; border-top: 2px solid #e0e0e0;">
                <h3 style="margin-bottom: 20px;">üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Admin ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>

                <div class="form-group">
                    <label>üë§ Username *</label>
                    <input type="text" name="admin_username" placeholder="admin" required>
                </div>

                <div class="form-group">
                    <label>üîí Password *</label>
                    <input type="password" name="admin_password" placeholder="********" required>
                </div>

                <div class="form-group full-width" style="margin-top: 30px;">
                    <button type="submit" class="btn" style="width: 100%; padding: 15px; font-size: 18px;">‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal ‡πÄ‡∏û‡∏¥‡πà‡∏° Reseller -->
    <div id="addResellerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° Reseller / Partner ‡πÉ‡∏´‡∏°‡πà</h2>
                <span class="close-btn" onclick="closeAddResellerModal()">&times;</span>
            </div>
            
            <form id="addResellerForm" onsubmit="submitReseller(event)">
                <div class="form-group full-width">
                    <label>üì¶ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡πá‡∏à Reseller *</label>
                    <div class="package-cards">
                        <div class="package-card" onclick="selectResellerPackage('Basic', 10, 450000)">
                            <div style="font-size: 36px;">üíº</div>
                            <h4>Reseller Basic</h4>
                            <div class="capacity">‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ 10 ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                            <div class="price">‡∏ø450,000</div>
                        </div>
                        <div class="package-card" onclick="selectResellerPackage('Pro', 25, 850000)">
                            <div style="font-size: 36px;">üèÜ</div>
                            <h4>Reseller Pro</h4>
                            <div class="capacity">‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ 25 ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div>
                            <div class="price">‡∏ø850,000</div>
                        </div>
                        <div class="package-card" onclick="selectResellerPackage('Master', 999, 1500000)">
                            <div style="font-size: 36px;">üëë</div>
                            <h4>Master Partner</h4>
                            <div class="capacity">‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î</div>
                            <div class="price">‡∏ø1,500,000</div>
                        </div>
                    </div>
                    <input type="hidden" id="resellerPackage" name="package" required>
                    <input type="hidden" id="resellerMaxSchools" name="max_schools" required>
                    <input type="hidden" id="resellerPrice" name="price" required>
                </div>

                <div class="form-group full-width">
                    <label>üè¢ ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• *</label>
                    <input type="text" name="name" placeholder="‡πÄ‡∏ä‡πà‡∏ô SOFTUBON CO.,LTD." required>
                </div>

                <div class="form-group">
                    <label>üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ *</label>
                    <input type="text" name="contact_name" placeholder="‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢" required>
                </div>

                <div class="form-group">
                    <label>üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ *</label>
                    <input type="tel" name="phone" placeholder="02-xxx-xxxx" required>
                </div>

                <div class="form-group">
                    <label>üìß ‡∏≠‡∏µ‡πÄ‡∏°‡∏• *</label>
                    <input type="email" name="email" placeholder="contact@company.com" required>
                </div>

                <div class="form-group">
                    <label>üìç ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î/‡πÄ‡∏Ç‡∏ï</label>
                    <input type="text" name="region" placeholder="‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£">
                </div>

                <div class="form-group">
                    <label>üìÖ ‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ *</label>
                    <input type="date" id="resellerExpireDate" name="expire_date" required>
                </div>

                <hr style="margin: 30px 0; border: none; border-top: 2px solid #e0e0e0;">
                <h3 style="margin-bottom: 20px;">üîë ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>

                <div class="form-group">
                    <label>üë§ Username *</label>
                    <input type="text" name="username" placeholder="reseller01" required>
                </div>

                <div class="form-group">
                    <label>üîí Password *</label>
                    <input type="password" name="password" placeholder="********" required>
                </div>

                <div class="form-group full-width" style="margin-top: 30px;">
                    <button type="submit" class="btn" style="width: 100%; padding: 15px; font-size: 18px;">‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Reseller</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentTab = 'dashboard';
        
        function showTab(tab) {
            document.querySelectorAll('[id$="Tab"]').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.tab-buttons .btn').forEach(btn => btn.style.background = '#6c757d');
            
            document.getElementById(tab + 'Tab').style.display = 'block';
            document.getElementById('btn' + tab.charAt(0).toUpperCase() + tab.slice(1)).style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            currentTab = tab;
            
            if (tab === 'dashboard') loadDashboard();
            if (tab === 'schools') loadSchools();
            if (tab === 'resellers') loadResellers();
            if (tab === 'finance') loadFinance();
        }

        function loadDashboard() {
            fetch('/api/super_admin/dashboard')
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        document.getElementById('totalSchools').textContent = data.stats.total_schools;
                        document.getElementById('totalResellers').textContent = data.stats.total_resellers;
                        document.getElementById('totalStudents').textContent = data.stats.total_students;
                        document.getElementById('monthlyRevenue').textContent = '‡∏ø' + data.stats.monthly_revenue.toLocaleString();
                        document.getElementById('expiringSoon').textContent = data.stats.expiring_soon;
                        document.getElementById('activeRate').textContent = data.stats.active_rate + '%';
                    }
                });
        }

        function loadSchools() {
            fetch('/api/schools')
                .then(res => res.json())
                .then(data => {
                    const tbody = document.querySelector('#schoolsTable tbody');
                    if (data.success && data.schools && data.schools.length > 0) {
                        tbody.innerHTML = data.schools.map(s => `
                            <tr>
                                <td>${s.school_id}</td>
                                <td><strong>${s.name}</strong></td>
                                <td>${s.package}</td>
                                <td>${s.current_students || 0}/${s.max_students}</td>
                                <td>${s.expire_date}</td>
                                <td><span class="badge badge-${s.status === 'active' ? 'active' : 'expired'}">${s.status === 'active' ? '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏'}</span></td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn btn-sm" onclick="viewSchool('${s.school_id}')">üëÅÔ∏è</button>
                                        <button class="btn btn-sm btn-warning" onclick="editSchool('${s.school_id}')">‚úèÔ∏è</button>
                                        <button class="btn btn-sm btn-success" onclick="renewSchool('${s.school_id}')">üîÑ</button>
                                        <button class="btn btn-sm btn-danger" onclick="deleteSchool('${s.school_id}')">üóëÔ∏è</button>
                                    </div>
                                </td>
                            </tr>
                        `).join('');
                    } else {
                        tbody.innerHTML = '<tr><td colspan="7" style="text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</td></tr>';
                    }
                });
        }

        function loadResellers() {
            fetch('/api/resellers')
                .then(res => res.json())
                .then(data => {
                    const tbody = document.querySelector('#resellersTable tbody');
                    if (data.success && data.resellers && data.resellers.length > 0) {
                        tbody.innerHTML = data.resellers.map(r => `
                            <tr>
                                <td>${r.reseller_id}</td>
                                <td><strong>${r.name}</strong></td>
                                <td>${r.package}</td>
                                <td>${r.schools_used || 0}/${r.max_schools}</td>
                                <td>‡∏ø${(r.commission || 0).toLocaleString()}</td>
                                <td>${r.expire_date}</td>
                                <td><span class="badge badge-${r.status === 'active' ? 'active' : 'expired'}">${r.status === 'active' ? '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏'}</span></td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn btn-sm" onclick="viewReseller('${r.reseller_id}')">üëÅÔ∏è</button>
                                        <button class="btn btn-sm btn-warning" onclick="editReseller('${r.reseller_id}')">‚úèÔ∏è</button>
                                        <button class="btn btn-sm btn-danger" onclick="deleteReseller('${r.reseller_id}')">üóëÔ∏è</button>
                                    </div>
                                </td>
                            </tr>
                        `).join('');
                    } else {
                        tbody.innerHTML = '<tr><td colspan="8" style="text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Reseller</td></tr>';
                    }
                });
        }

        function loadFinance() {
            fetch('/api/super_admin/revenue')
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        document.getElementById('todayRevenue').textContent = '‡∏ø' + (data.revenue.today || 0).toLocaleString();
                        document.getElementById('monthRevenue').textContent = '‡∏ø' + (data.revenue.month || 0).toLocaleString();
                        document.getElementById('yearRevenue').textContent = '‡∏ø' + (data.revenue.year || 0).toLocaleString();
                        document.getElementById('pendingPayment').textContent = '‡∏ø' + (data.revenue.pending || 0).toLocaleString();
                    }
                });
            loadPayments();
        }

        function openAddSchoolModal() {
            document.getElementById('addSchoolModal').style.display = 'block';
        }

        function closeAddSchoolModal() {
            document.getElementById('addSchoolModal').style.display = 'none';
            document.getElementById('addSchoolForm').reset();
            document.querySelectorAll('#addSchoolModal .package-card').forEach(card => card.classList.remove('selected'));
        }

        function selectSchoolPackage(name, capacity, monthly, yearly, lifetime) {
            document.querySelectorAll('#addSchoolModal .package-card').forEach(card => card.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            document.getElementById('schoolPackage').value = name;
            document.getElementById('schoolMaxStudents').value = capacity;
            
            const expireDate = new Date();
            expireDate.setFullYear(expireDate.getFullYear() + 1);
            document.getElementById('schoolExpireDate').value = expireDate.toISOString().split('T')[0];
        }

        function submitSchool(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());
            data.max_students = parseInt(data.max_students);
            data.status = 'active';
            
            fetch('/api/schools', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏£‡∏´‡∏±‡∏™: ' + data.school_id);
                    closeAddSchoolModal();
                    loadSchools();
                } else {
                    alert('‚ùå ' + data.message);
                }
            });
        }

        function openAddResellerModal() {
            document.getElementById('addResellerModal').style.display = 'block';
        }

        function closeAddResellerModal() {
            document.getElementById('addResellerModal').style.display = 'none';
            document.getElementById('addResellerForm').reset();
            document.querySelectorAll('#addResellerModal .package-card').forEach(card => card.classList.remove('selected'));
        }

        function selectResellerPackage(name, maxSchools, price) {
            document.querySelectorAll('#addResellerModal .package-card').forEach(card => card.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            document.getElementById('resellerPackage').value = name;
            document.getElementById('resellerMaxSchools').value = maxSchools;
            document.getElementById('resellerPrice').value = price;
            
            const expireDate = new Date();
            expireDate.setFullYear(expireDate.getFullYear() + 3);
            document.getElementById('resellerExpireDate').value = expireDate.toISOString().split('T')[0];
        }

        function submitReseller(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData.entries());
            data.max_schools = parseInt(data.max_schools);
            data.price = parseFloat(data.price);
            
            fetch('/api/resellers', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á Reseller ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏£‡∏´‡∏±‡∏™: ' + data.reseller_id);
                    closeAddResellerModal();
                    loadResellers();
                } else {
                    alert('‚ùå ' + data.message);
                }
            });
        }

        function openPaymentModal() {
            const schoolId = prompt('‡∏£‡∏´‡∏±‡∏™‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):');
            const amount = prompt('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó):');
            if (!amount) return;
            
            const paymentType = prompt('‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (monthly/yearly/lifetime):');
            const notes = prompt('‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:');
            
            fetch('/api/super_admin/payments', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    school_id: schoolId,
                    amount: parseFloat(amount),
                    payment_type: paymentType || 'monthly',
                    notes: notes || ''
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n‡∏£‡∏´‡∏±‡∏™: ' + data.payment_id);
                    loadFinance();
                    loadPayments();
                }
            });
        }

        function loadPayments() {
            fetch('/api/super_admin/payments')
                .then(res => res.json())
                .then(data => {
                    const tbody = document.querySelector('#paymentsTable tbody');
                    if (data.success && data.payments && data.payments.length > 0) {
                        tbody.innerHTML = data.payments.map(p => `
                            <tr>
                                <td>${p.payment_date.split('T')[0]}</td>
                                <td>${p.school_id || p.reseller_id || '-'}</td>
                                <td>${p.payment_type}</td>
                                <td>‡∏ø${p.amount.toLocaleString()}</td>
                                <td><span class="badge badge-${p.status === 'completed' ? 'active' : 'warning'}">${p.status}</span></td>
                                <td>${p.notes || '-'}</td>
                            </tr>
                        `).join('');
                    } else {
                        tbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</td></tr>';
                    }
                });
        }

        function viewSchool(id) {
            fetch(`/api/schools/${id}`)
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        const s = data.school;
                        alert(`üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô\n\n` +
                            `‡∏£‡∏´‡∏±‡∏™: ${s.school_id}\n` +
                            `‡∏ä‡∏∑‡πà‡∏≠: ${s.name}\n` +
                            `‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: ${s.province || '-'}\n` +
                            `‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡πá‡∏à: ${s.package}\n` +
                            `‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: ${s.max_students}\n` +
                            `‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: ${s.expire_date}\n` +
                            `‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${s.status}`);
                    }
                });
        }

        function editSchool(id) {
            fetch(`/api/schools/${id}`)
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        const s = data.school;
                        const name = prompt('‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:', s.name);
                        if (!name) return;
                        
                        const province = prompt('‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î:', s.province);
                        const expireDate = prompt('‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (YYYY-MM-DD):', s.expire_date);
                        
                        fetch(`/api/schools/${id}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ name, province, expire_date: expireDate })
                        })
                        .then(res => res.json())
                        .then(data => {
                            if (data.success) {
                                alert('‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                                loadSchools();
                            }
                        });
                    }
                });
        }

        function renewSchool(id) {
            const newDate = prompt('‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏´‡∏°‡πà (YYYY-MM-DD):');
            if (!newDate) return;
            
            fetch(`/api/schools/${id}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ expire_date: newDate, status: 'active' })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ ‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    loadSchools();
                } else {
                    alert('‚ùå ' + data.message);
                }
            });
        }

        function deleteSchool(id) {
            if (!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ô‡∏µ‡πâ? (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£)')) return;
            
            fetch(`/api/schools/${id}`, { method: 'DELETE' })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ ‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    loadSchools();
                } else {
                    alert('‚ùå ' + data.message);
                }
            });
        }

        function viewReseller(id) {
            fetch(`/api/resellers/${id}`)
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        const r = data.reseller;
                        const c = data.commission;
                        alert(`üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î Reseller\n\n` +
                            `‡∏£‡∏´‡∏±‡∏™: ${r.reseller_id}\n` +
                            `‡∏ä‡∏∑‡πà‡∏≠: ${r.name}\n` +
                            `‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡πá‡∏à: ${r.package}\n` +
                            `‡∏Ç‡∏≤‡∏¢‡πÑ‡∏î‡πâ: ${r.max_schools} ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô\n` +
                            `‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß: ${r.schools_used || 0} ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô\n` +
                            `‡∏£‡∏≤‡∏Ñ‡∏≤: ‡∏ø${r.price.toLocaleString()}\n` +
                            `Commission: ‡∏ø${c.commission.toLocaleString()} (${c.commission_rate}%)\n` +
                            `‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: ${r.expire_date}`);
                    }
                });
        }

        function editReseller(id) {
            fetch(`/api/resellers/${id}`)
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        const r = data.reseller;
                        const name = prompt('‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó:', r.name);
                        if (!name) return;
                        
                        const phone = prompt('‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:', r.phone);
                        const email = prompt('‡∏≠‡∏µ‡πÄ‡∏°‡∏•:', r.email);
                        
                        fetch(`/api/resellers/${id}`, {
                            method: 'PUT',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ name, phone, email })
                        })
                        .then(res => res.json())
                        .then(data => {
                            if (data.success) {
                                alert('‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                                loadResellers();
                            }
                        });
                    }
                });
        }

        function deleteReseller(id) {
            if (!confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö Reseller ‡∏ô‡∏µ‡πâ?')) return;
            
            fetch(`/api/resellers/${id}`, { method: 'DELETE' })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ ‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    loadResellers();
                } else {
                    alert('‚ùå ' + data.message);
                }
            });
        }

        function searchSchools(query) {
            const rows = document.querySelectorAll('#schoolsTable tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(query.toLowerCase()) ? '' : 'none';
            });
        }

        function searchResellers(query) {
            const rows = document.querySelectorAll('#resellersTable tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(query.toLowerCase()) ? '' : 'none';
            });
        }

        function generateReport() {
            const type = document.getElementById('reportType').value;
            const period = document.getElementById('reportPeriod').value;
            
            document.getElementById('reportResult').innerHTML = '<p style="text-align: center; padding: 20px;">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô...</p>';
            
            setTimeout(() => {
                document.getElementById('reportResult').innerHTML = `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô${type === 'revenue' ? '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ' : type === 'schools' ? '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' : type === 'resellers' ? 'Reseller' : '‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏'}</h3>
                        <p>‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤: ${period === 'today' ? '‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ' : period === 'month' ? '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ' : '‡∏õ‡∏µ‡∏ô‡∏µ‡πâ'}</p>
                        <p style="margin-top: 20px;">‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Ñ‡∏•‡∏¥‡∏Å Export ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</p>
                    </div>
                `;
            }, 1000);
        }

        function exportExcel() {
            alert('üìÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á Export ‡πÄ‡∏õ‡πá‡∏ô Excel...\n\n‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á library ‡πÄ‡∏ä‡πà‡∏ô xlsx.js');
        }

        function exportPDF() {
            alert('üìÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á Export ‡πÄ‡∏õ‡πá‡∏ô PDF...\n\n‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á library ‡πÄ‡∏ä‡πà‡∏ô jsPDF');
        }

        function saveSettings() {
            const settings = {
                company_name: document.querySelector('input[type="text"]').value,
                email: document.querySelector('input[type="email"]').value,
                phone: document.querySelector('input[type="tel"]').value,
                line_oa: document.querySelectorAll('input[type="text"]')[1].value,
                expiry_alert_days: parseInt(document.querySelector('input[type="number"]').value)
            };
            
            fetch('/api/super_admin/settings', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(settings)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                }
            });
        }

        // Initialize Charts
        const revenueCtx = document.getElementById('revenueChart').getContext('2d');
        new Chart(revenueCtx, {
            type: 'line',
            data: {
                labels: ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.'],
                datasets: [{
                    label: '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (‡∏ö‡∏≤‡∏ó)',
                    data: [120000, 190000, 150000, 220000, 180000, 250000],
                    borderColor: '#667eea',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: { display: true, text: '‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô' }
                }
            }
        });

        const schoolsCtx = document.getElementById('schoolsChart').getContext('2d');
        new Chart(schoolsCtx, {
            type: 'bar',
            data: {
                labels: ['Starter', 'Professional', 'Business', 'Enterprise'],
                datasets: [{
                    label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                    data: [12, 25, 8, 3],
                    backgroundColor: ['#4CAF50', '#2196F3', '#FF9800', '#9C27B0']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: { display: true, text: '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡πá‡∏à' }
                }
            }
        });

        // Load initial data
        showTab('dashboard');
    </script>
</body>
</html>
